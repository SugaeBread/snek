<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/design.css">
  <script type="text/javascript" src="js/expendTab.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel = "icon" href = "images/logos/snek.jpg" type = "image/x-icon">
  <title>How?</title>
</head>
<body>
  <header>
    <ul>
      <li class="navbar"><a href="index.html" style= "color: #0FFF50;">Snek</a></li>
      <li class="navbar"><a href="whatSnek.html">What?</a></li>
      <li class="navbar"><a href="whySnek.html">Why?</a></li>
      <li class="navbar"><a href="howSnek.html">How?</a></li>
      <li class="navbar"><a href="whoSnek.html">Who?</a></li>
    </ul>
  </header>
  <div class="content-box">
    <h1>How Snek?</h1>
    <h2>In this page, I will detail how I made the snake game using only W3School tutorials and little help from the folks at Stack Overflow.</h2>
    <button type="button" onclick="expend(this)" class="collapsible">In the Beginning I Created a Canvas</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-7">
          <p>From the W3School tutorial, it first shows how to create a canvas for the game to take place in, I chose to make it 1280 x 720 because I have a 1080p screen, I figured making it a little smaller than my screen would be ideal.</p>
        </div>
        <div class="col-sm-5">
          <a href="images/screenshots/canvas.jpg" target="_blank">
            <img src="images/screenshots/canvas.jpg" alt="canvas"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Let There be a Red Cube</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-5">
          <a href="images/screenshots/redCube.jpg" target="_blank">
            <img src="images/screenshots/redCube.jpg" alt="Red Cube"></img>
          </a>
        </div>
        <div class="col-sm-7">
          <p>Then W3School shows how to make a red cube as the player, which is a variable that contain its size, color, x and y position. I did as it said and blam! A RED CUBE!</p>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Time to Get Moving</button>
    <div class="content">
      <p>I then continue following the tutorial on how to make the red cube move. Making the canvas update about 7 times every second, and adjusting the red cube's position every frame. It was at this point I started deviating from the tutorial.
        I knew I wanted to make a snake game, so I divided my canvas into a grid, with every squre being 40 x 40, and the red cube would move 40 pixels at a time to match this grid.</p>
      <div class="row">
        <div class="col-sm-6">
          <a href="images/screenshots/grid.jpg" target="_blank">
            <img src="images/screenshots/grid.jpg" alt="Grid"></img>
          </a>
        </div>
        <div class="col-sm-6">
          <a href="images/screenshots/movingCube.jpg" target="_blank">
            <img src="images/screenshots/movingCube.jpg" alt="Moving Cube"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Hey I Found my Ctrl Key</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-7">
          <p>I then used an event listener to get player's key input, as taught by w3school.
            but for the snake game, there are some things about input to keep in mind:</p>
          <ol>
            <li><h4>Input Delay</h4>
              <p>The snake game update 7 times per second, so the game is only checking for input every ~0.15 second. This makes the input VERY unresponsive and often wouldn't even detect inputs.
                To remedy this, I just added another interval to check for update every 0.001 seconds, this massively improve the responsiveness. Though it still misses input rarely, I've accepted defeat and view this as a compromise to making games in HTML.<p></li>
            <li><h4>Opposite Direction</h4>
              <p>In snake, you should not be able to move to the opposite direction you're going, since you would hit your own tail. The first way I tried to avoid this is to just stop the snake from moving to a direction that it has already chosen.
                This works great! Until it doesn't. Because the game runs at 0.15 fps, but the input updates at 0.001 interval, I can quickly change the snake's direction twice before it takes a move, allowing me to force the snake to move into itself.
                To solve this proble, I create a varible to record the snake last move, and use that to prevent the snake from going back to its last position, this works great.</p></li>
          </ol>
        </div>
        <div class="col-sm-5">
          <a href="images/screenshots/controlledCube.jpg" target="_blank">
            <img src="images/screenshots/controlledCube.jpg" alt="Controlled Cube"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Heads or Tails?</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-5">
          <a href="images/screenshots/amongus.jpg" target="_blank">
            <img src="images/screenshots/amongus.jpg" alt="Drawing with Tail"></img>
          </a>
        </div>
        <div class="col-sm-7">
          <p>Next is to create the tail for our snake, this is a mechanic unique to snake so w3shool ain't going to hold my hand anymore. I started by creating a function similar to the red cube, except I can't control it.
            Then I added one of this function to the player's position every frame. Allowing me to use it to draw on the canvas.</p>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">A Snek was Born</button>
    <div class="content">
      <p>To make the tail act like a tail, every frame I use an array to set the first tail piece to occupy the player's last position, the second one to occupy the first one's last position...etc.
        I scaled this up by adding a button that would add a tail piece every time I press it. And magically, it worked the first time without much hassle.</p>
      <div class="row">
        <div class="col-sm-6">
          <a href="images/screenshots/tailFinish.jpg" target="_blank">
            <img src="images/screenshots/tailFinish.jpg" alt="Tail"></img>
          </a>
        </div>
        <div class="col-sm-6">
          <a href="images/screenshots/extendedTail.jpg" target="_blank">
            <img src="images/screenshots/extendedTail.jpg" alt="Long Tail"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Food Good</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-7">
          <p>After checking the tail can properly grow using a button. I decided to incorporate the food mechanic to give the game a target. Creating the food is like creating the player and the tails component. But there are some rules to them.</p>
          <ol>
            <li><h4>Spawn Location</h4>
              <p>The spawn location of food is randomized, and should be on the grid. But the annoying part is to avoid the food from spawning inside the snake, I used a do-while loop to check every time a food is spawned to check if its position is intersecting with any body part of the snake</p>
            </li>
            <li><h4>Obtaining the Food</h4>
              <p>To know if the snake has obtained the food, I added a function to check if the food position and the player's position interact every frame, if they do, the food is deleted, a tail piece is added to the player, and a new food would be spawned.</p>
            </li>
          </ol>
        </div>
        <div class="col-sm-5">
          <a href="images/screenshots/foodFinish.jpg" target="_blank">
            <img src="images/screenshots/foodFinish.jpg" alt="Food"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Wall Bad, Wall Kills, Don't Touch Wall</button>
    <div class="content">
      <p>Now to make collision possible, and subsequently, a game over condition. I first thought this is going to be the hardest part of this project because of integration hell. This is the first game mechanic that would be heavily affected by previous game mechanic,
        so I went into this expecting the worst. But surprisingly, it wasn't that bad. The collision can be seperated into two parts.</p>
      <ol>
        <li><h4>Canvas Wall</h4>
          <p>To detect if the player had hit the wall, every time the player move, if the snake's position is outside of the canvas, it means it has hit the wall. And therefore, it is a game over.</p>
        </li>
        <li><h4>Tail</h4>
          <p>This is the part I'm worry about. Since the tails are following the player. I was fully expecting the player's position would sometimes overlap with the first tail piece's position.
          But as it turns out, either because the tail only move after the player has moved, or because the collision detection only occur after the player moving, it actually worked as intented.
          And game over only occur when I clearly run my player into its tail piece.</p>
        </li>
      </ol>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Snek is Dead</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-7">
          <p>No joke, this was the part I spent the longest on. And it isn't even really gameplay related. I failed so many times making the game over screen that I am going to use point form to state how each attempt ended up.</p>
          <ol>
            <li><h4>Semi-transparent Death Screen</h4>
              <p>My first attempt to make a game over screen was to make a transparent overlay to the game area, and putting text like "Game Over" on it. I tried this by creating a black screen on the canvas and set its opacity to 50%. And make it appear upon snake collision.
                It was successful in that it appear after collision, what wasn't though, is that it's not transparent, a grey screen appear, I tried for another hour but I cannot seem to get the screen to be transparent. This was when I give up on this method.</p>
            </li>
            <li><h4>Non-transparent Death Screen</h4>
              <p>Accepting my defeat, I resorted to using just a black screen, but somehow this causes even more problem. You'd think if I can already make a grey screen, a black screen would be trivial. But it was far from the truth. Up to this point I haven't touched the canvas at all,
                a lot of the stuff was "borrowed" from w3school. Now I have to write a whole function for the canvas that would change it to a game over screen. And I have no idea what some of the command means. After hours of trials and errors, I realize the only important things is re-declearing its width and height and it clears it.
                I am sure there are better alternatives for doing it, but I was just more than frustrated at this point so I left it at that.</p>
            </li>
            <li><h4>Writing Words on a Canvas</h4>
              <p>With the black screen taken up half of the development time, I finally moved on the writing the "Game Over" text on it. At least this part have tutorials... Oh wait, I have no idea what a canvas context is. And after another half an hour of painstaking code reading,
                I finally understood how to write words on the screen using this "context" thingy. Victory at last.</p>
            </li>
            <li><h4>Instant Restart</h4>
              <p>Originally, I wanted the player to be able to press any key to restart the game upon dying. So I used the update function to check for this upon dying, but something with event listener just kept bugging out and even though I have released any key for over a second, it still auto restarted my game upon death.
                I tried to add a delay using set interval to prevent this bug, but somehow it only works upon the first death the player has. At the end, I accepted defeat and set the restart button to Spacebar, a key that wouldn't be pressed normally during gameplay so the bug wouldn't register normally.</p>
            </li>
          </ol>
        </div>
        <div class="col-sm-5">
          <a href="images/screenshots/gameoverScreen.jpg" target="_blank">
            <img src="images/screenshots/gameoverScreen.jpg" alt="Game Over Screen"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Score!!!</button>
    <div class="content">
      <p>Next is to give the player a sense of satisfaction, and what is better than letting them know how they did in a game by implementing a scoring systen. It increases by 50 every time your snake eats a food, and it tells the player what score they got at the end of the game. Giving player motivation to improve and keep playing.</p>
      <div class="row">
        <div class="col-sm-6">
          <a href="images/screenshots/scoring.jpg" target="_blank">
            <img src="images/screenshots/scoring.jpg" alt="Score"></img>
          </a>
        </div>
        <div class="col-sm-6">
          <a href="images/screenshots/gameoverScore.jpg" target="_blank">
            <img src="images/screenshots/gameoverScore.jpg" alt="Game Over Screen with Score"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Welcome to Snek!</button>
    <div class="content">
      <div class="row">
        <div class="col-sm-7">
          <p>Every game needs a introduction, you can't just go right in expect the players to know how to play the game (even though snake is like the single most intuitive game). Anyways, a introduction screen is needed. And it is pain, once again. Yep, the game over screen and the introduction screen together at least took up 70% of
            the development time and they are not even gameplay related, I don't know how, and I am losing my sanity thinking about it so let's move on. Right, introduction screen.</p>
          <ol>
            <li><h4>Reuse Codes</h4>
              <p>You would think since I made a game over screen, I would be full capable of making a intro screen right? Haha, you funny. I thought the same when I made another function for the game area before starting the game, and... it broke.
                Why? Well for the game over screen, everything has already been decleared, and I only had to clear the canvas and put on the game over screen. And for the intro screen, nothing is decleared yet. So either I completely redo the game start function and intergrate it into the intro screen, and risking even more bugs.
                Or I can just nope out and find another option.</p>
            </li>
            <li><h4>New Canvas</h4>
              <p>If I can't edit my game canvas without messing up everything, I'll just make another canvas to host the intro screen...well there are problems here as well. I had to write a whole new function to create this canvas but that's nothing, I then have to delete this canvas and replace it with the game canvas. I find a way to destroy
                the canvas, but even on Stackoverflow people are only giving out advice to clearing the canvas, which still leave a blank, but very much present canvas there. I searched everywhere on the web and I just cannot find a way to delete an existing canvas. I was about to give up this method as well when I realize: I don't have to
                completely delete the canvas, I only have to make it invisible. So I ended up just making its dimension 0px * 0px, a VERY scuff solution, but hey it works.</p>
            </li>
          </ol>
        </div>
        <div class="col-sm-5">
          <a href="images/screenshots/intro.jpg" target="_blank">
            <img src="images/screenshots/intro.jpg" alt="Intro Screen"></img>
          </a>
        </div>
      </div>
    </div>
    <button type="button" onclick="expend(this)" class="collapsible">Other Bugs I couldn't Mention</button>
    <div class="content">
      <div class="row">
        <ul>
          <div class="row">
            <div class="col-sm-7">
              <li><h4>Misaligned Pixels</h4>
                <p>If you look closely to the snake, especially when you curl it up into a cube, you may find their x-position or y-position a bit misaligned, by a pixel or two. I cannot explain this as they all should be on the same x or y position. I put this as just html's scaling and rendering issue.</p>
              </li>
            </div>
            <div class="col-sm-5">
              <a href="images/screenshots/misaligned.jpg" target="_blank">
                <img src="images/screenshots/misaligned.jpg" alt="Misaligned Pixels"></img>
              </a>
            </div>
          </div>
          <li><h4>Accelerating Snake</h4>
            <p>At the start of development, the snake would strangely get faster and faster every time the game restart. I later realize this is because I didn't clear the game area's interval. So every time the game restart, it would create another update function and the snake would update twice as fast.</p>
          </li>
          <li><h4>Restart Anytime</h4>
            <p>Even though I set the pregame canvas to 0 px to make it appear to be destroyed, all its logics are still intact so even after starting the game, I can press Spacebar to activate its start game logic. Restarting the game with a unrefreshed score. To solve this, I just added a varible to check if the game is started.</p>
          </li>
        </ul>
      </div>
    </div>
</body>
</html>
